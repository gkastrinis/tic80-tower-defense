function BOOT()
	Castle={x=108,y=48,hp=5,gold=10}
	Skull={x=0,y=52}
end

function remap(tile,x,y)
	local flip,rotate=0,0
	if x==8 and y==11 then flip=1 end
	if x==8 and y==7 then rotate=1 end
	if x==19 and y==6 then flip=1;rotate=1 end
	if x==23 and y==8 then flip=1 end
	if x==23 and y==2 then rotate=1 end
	if x==26 and y==2 then flip=1;rotate=1 end

	if (x>=4 and x<= 7 and y==11) or
		(x>=9 and x<=13 and y==7) or
		(x>=15 and x<=18 and y==6) or
		(x>=20 and x<=22 and y==8) or
		(x>=24 and x<=25 and y==2) then
		rotate=1
	end
	return tile,flip,rotate
end

function TIC()
	if btn(0) then Skull.y=Skull.y-1 end
	if btn(1) then Skull.y=Skull.y+1 end
	if btn(2) then Skull.x=Skull.x-1 end
	if btn(3) then Skull.x=Skull.x+1 end
	if btnp(4) then Castle.hp=Castle.hp-1 end
	if btnp(5) then Castle.hp=Castle.hp+1 end
	if btnp(6) then Castle.gold=Castle.gold-1 end
	if btnp(7) then Castle.gold=Castle.gold+1 end

	map(0,0,30,17,0,0,-1,1,remap)
	DrawHUD()
	spr(288,Castle.x,Castle.y,0,1,0,0,2,2)
	spr(258,Skull.x,Skull.y,0,1,1,0,1,1)
	-- spr(256,Skull.x//2,Skull.y,0,1,1,0,2,2)
end

function DrawHUD()
	local fullHearts=math.floor(Castle.hp/2)
	for i=1,fullHearts do
		spr(292,240-16*i,120,0,1,0,0,2,2)
	end
	if math.fmod(Castle.hp,2)==1 then
		spr(293,240-16*fullHearts-8,120,0,1,0,0,1,2)
	end

	spr(290,0,120,0,1,0,0,2,2)
	print(Castle.gold,16,124,12,false,2)
end

-- <TILES>
-- 003:eccccccccc888888caaaaaaaca888888cacccccccacccccccacc0ccccacc0ccc
-- 004:ccccceee8888cceeaaaa0cee888a0ceeccca0cccccca0c0c0cca0c0c0cca0c0c
-- 016:6766666677766666777666666366766666677766666777666666366666666666
-- 019:cacccccccaaaaaaacaaacaaacaaaaccccaaaaaaac8888888cc000cccecccccec
-- 020:ccca00ccaaaa0ccecaaa0ceeaaaa0ceeaaaa0cee8888ccee000cceeecccceeee
-- 032:6666666666666666666666666666666666666666666666666666666666666666
-- 048:6434c44663344446634c4d466444de466444e4466444444664ed44c664e44c46
-- 064:644444766444c47764c44777644444446e444c446fee444466fe444c66666666
-- </TILES>

-- <SPRITES>
-- 000:00000000000000000000000000000ccc0000cccc0000cccc000c32cc000c32cc
-- 001:00000000000000000000000044400000c4430000cc4400003244300032443000
-- 002:0ffffff0ffcccddffcccccdf02c22cdffcfcccdffccccdff0fcfcdf00ffffff0
-- 016:000ccc3c0000cc3c00000ccc00004343000044c4000004440000000000000000
-- 017:cc443000c4433000c343000044400000c4300000400000000000000000000000
-- 018:000000000ff0ff00fc3f32f0f33322f00f332f0000f2f000000f000000000000
-- 032:00000000000e0ee0000eeeee000ddddd0e0edede0eeeeeee0ddddd2c0d84dd2c
-- 033:00000000e0e0f000eeeef000dddff000edeff0f0eeeefff02ddddff02d84ddf0
-- 034:0000000000000044000000440000444400044433000443000004440000034444
-- 035:0000000000000000000000004400000044400000344000000330000044000000
-- 036:0000000000000000000000000012220000222220012222220122222201222222
-- 037:00000000000000000000000002221000222220002cc2220022cc2200222c2200
-- 048:0d89dd220d89ddd20d88dddd0dddddff0ddddfef0d7ddfef0777dfff77777766
-- 049:2d89dff0dd89dff0dd88ddf0fddddff0efdddff0efdddf70ffddd77066677777
-- 050:0000344400000333000440000004440000034444000033440000004400000033
-- 051:4440000034400000044000004440000044300000330000000000000000000000
-- 052:0112222200122222001122220001122200001122000001120000001100000000
-- 053:2222220022222000222220002222000022200000220000002000000000000000
-- </SPRITES>

-- <MAP>
-- 000:020202030202020202020202020203020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:020202030202020202020202020203020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 002:020202030202020202020202020203020202020202020204030304020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 003:020202030202020202020202020103010202020202020203020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:020202030102020202020202020203020102020202020203020103020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 005:020201030202020202020202010203010102020202020203020103020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 006:020101030202020202020201020203030303030402020203020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 007:020202030202020204030303030302020201020302020203020203010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 008:020201030202020203020202020202020202020403030304020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 009:020202030202020203020202020202020202020202020202020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 010:020202030202020203020202020202020202010202020202020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:020202040303030304010202020202020201020202020202020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:020202020202020202020202020202020202020202020202020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:020202020201010101020202020202020202020202020101020203020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:010101010101010101010101010101010101010101010101010103010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000304000000000
-- </SFX>

-- <TRACKS>
-- 000:100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </TRACKS>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

